{% comment %}

This include takes a lesson page and returns the appropriate filename slug.

For en pages, the base url is used; for es pages, the assigned "redirect_from" value is used.

These slugs are used in several locations:

1. Generating lesson image links and URLs for en/es lesson index pages in _includes/lesson_describe.html
2. Finding the lesson avatar to display on the individual lesson page, generated by _layouts/lesson.html
3. Finding image paths for use within individual lesson and blog posts when using _includes/figure.html

Note that this inlude defaults to using the current "page" as its environment. This is great when generating slugs for the current page being generated.
However, when generating lesson links/avatars via _includes/lesson_describe.html for the lesson index pages, we need to explicitly pass lesson objects in a loop. 

{% endcomment %}

{% if include.lesson %}
  {% assign lessonobj = include.lesson %}
{% else %}
  {% assign lessonobj = page %}
{% endif %}

{% if lessonobj.redirect_from %}
  {% assign canonical_url = lessonobj.redirect_from %}
{% else %}
  {% assign canonical_url = lessonobj.url %}
{% endif %}

{% assign slug = canonical_url | split: "/" | last | remove_first: ".html" %}

{% assign original = lessonobj.redirect_from | split: "/" | last | remove_first: ".html" %}
